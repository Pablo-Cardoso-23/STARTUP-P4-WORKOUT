<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Rotina Alimentar - P4 WORKOUT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: black;
        }

        h1 {
            color: white;
            margin-bottom: 30px;
            font-weight: bold;
        }

        h2 {
            font-size: 1.5rem;
            font-weight: bold;
            color: black;
        }

        h3 {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }

        span {
            color: red;
        }

        section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        nav {
            background-color: white;
        }

        nav .nav-link {
            font-size: 1.2rem !important;
            font-weight: bold;
        }

        nav a:hover {
            transform: scale(1.2);
            color: #ff6600;
        }

        .rotina-card {
            background-color: white;
            color: black;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .lista-exercicios {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .exercicio-item {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .nome-exercicio {
            font-weight: 500;
            color: #333;
        }

        .botoes-exercicio .btn{
            font-size: 0.85rem;
            padding: 4px 8px;
        }
    </style>

</head>
<body class="d-flex flex-column min-vh-100">

<header class="text-center py-3">
    <h1>P<span style="color:red;">4</span> WORKOUT</h1>
    <h3 class="mt-2">Gerenciamento de Rotinas Alimentares</h3>
</header>

<main class="flex-grow-1 container my-4">

    <div class="mb-4 text-center">
        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modalAddRotina">+ Criar Nova Rotina</button>
    </div>

    {% for rotina in rotinas %}
    <div class="rotina-card mb-4 p-3 border rounded">
        <div class="d-flex justify-content-between align-items-center">
            <h2>{{ rotina.nome }}</h2>
            <div>
                <button type="button" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#modalEditarRotina{{ rotina.id }}">Editar</button>
                <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#modalExcluirRotina{{ rotina.id }}">Excluir</button>
            </div>
        </div>

        <ul class="mt-3 list-group">
            {% for dia, alimentos in rotina.alimentos.items() %}
            <li class="list-group-item">
                <strong>{{ dia }}:</strong>
                {% if alimentos %}
                    <ul>
                        {% for alimento in alimentos %}
                        <li class="d-flex justify-content-between align-items-center">
                            {{ alimento }}
                            <div>
                                <button type="button" class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#modalEditarAlimento{{ rotina.id }}{{ loop.index0 }}{{ dia }}">Editar</button>
                                <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#modalExcluirAlimento{{ rotina.id }}{{ loop.index0 }}{{ dia }}">Excluir</button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <span class="text-muted">Nenhum alimento adicionado</span>
                {% endif %}
                <button class="btn btn-dark btn-sm mt-2" data-bs-toggle="modal" data-bs-target="#modalAddAlimento{{ rotina.id }}{{ dia }}">+ Adicionar Alimento</button>
            </li>
            {% endfor %}
        </ul>
    </div>

    <div class="modal fade" id="modalEditarRotina{{ rotina.id }}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Rotina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="/rotinas/{{ rotina.id }}/editar" method="post">
                    <div class="modal-body">
                        <input type="text" name="nome" class="form-control" value="{{ rotina.nome }}" required>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-dark">Salvar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalExcluirRotina{{ rotina.id }}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h5 class="modal-title">Excluir Rotina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    Tem certeza que deseja excluir a rotina <strong>{{ rotina.nome }}</strong>?
                </div>
                <div class="modal-footer">
                    <form action="/rotinas/{{ rotina.id }}/excluir" method="post">
                        <button type="submit" class="btn btn-danger">Excluir</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    {% endfor %}

    <div class="modal fade" id="modalAddRotina" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content text-dark">
                <div class="modal-header">
                    <h5 class="modal-title">Criar Nova Rotina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="/rotinas/adicionar" method="post">
                    <div class="modal-body">
                        <input type="text" name="nome" class="form-control" placeholder="Nome da rotina" required>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-dark">Salvar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</main>

<nav class="navbar navbar-light bg-light fixed-bottom">
    <div class="container justify-content-around">
        <a class="nav-link text-black" href="/menu">Menu</a>
        <a class="nav-link text-black" href="/chatbot">Chat</a>
        <a class="nav-link text-black" href="/rotina">Rotina</a>
    </div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>